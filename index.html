<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>JRAコース早見（段階カラー版）</title>
<style>
  body{font-family:sans-serif;background:#f5f6f8;margin:0;color:#0f172a}
  header{background:#0f766e;color:#fff;padding:14px 16px;font-weight:700}
  .tabs{display:flex;gap:8px;background:#f5f6f8;padding:10px}
  .tab-btn{flex:1;border:none;border-radius:9999px;padding:8px 10px;font-weight:600;color:#64748b;background:rgba(255,255,255,.0)}
  .tab-btn.active{background:#fff;color:#0f172a;box-shadow:0 4px 14px rgba(15,118,110,.15)}
  .page{display:none;padding:12px}
  .page.active{display:block}
  .card{background:#fff;border-radius:16px;padding:14px;margin-bottom:12px;box-shadow:0 4px 20px rgba(15,23,42,.03)}
  .bar-wrapper{margin-top:10px}
  .bar-label{display:flex;justify-content:space-between;font-size:.7rem;color:#64748b;margin-bottom:3px}
  .bar-track{height:8px;background:#e2e8f0;border-radius:9999px;overflow:hidden}
  .bar-fill{height:100%;width:0;transition:width .3s}
</style>
</head>
<body>
  <header>JRAコース早見<small style="display:block;font-weight:400;font-size:.7rem;opacity:.8">段階カラー表示</small></header>
  <div class="tabs">
    <button class="tab-btn active" data-tab="view">タブ1：見る</button>
    <button class="tab-btn" data-tab="input">タブ2：入力</button>
  </div>
  <div class="page active" id="view">
    <div class="card">
      <label>競馬場</label>
      <select id="selCourse"><option>東京</option><option>中山</option><option>京都</option></select>
      <label>馬場</label>
      <select id="selSurface"><option value="芝">芝</option><option value="ダート">ダート</option></select>
      <label>距離</label>
      <select id="selDistance"><option>2000</option><option>1600</option></select>
    </div>
    <div class="card" id="viewCard"></div>
  </div>
  <div class="page" id="input">
    <div class="card" id="inputCard"></div>
  </div>
<script>
const allCourses=["東京","中山","京都"];
const todayTrack={};

function colorByCushion(v){
 if(v===null||v===0)return"#e5e7eb";
 if(v>=10.5)return"#16a34a";
 if(v>=9)return"#a3e635";
 if(v>=8)return"#facc15";
 return"#f97316";
}
function colorByWater(v){
 if(v===null||v===0)return"#e5e7eb";
 if(v<=10)return"#16a34a";
 if(v<=20)return"#facc15";
 if(v<=30)return"#f97316";
 return"#ef4444";
}

const inputCard=document.getElementById('inputCard');
allCourses.forEach(c=>{
 const div=document.createElement('div');
 div.className='bar-wrapper';
 div.innerHTML=`<div style='font-weight:700;margin-bottom:6px;'>${c}</div>
 <div><label>芝 クッション</label><input type='number' step='0.1' min='5' max='12' id='${c}-芝-cush' style='width:70px;'>
 <label>芝 含水</label><input type='number' step='0.1' min='0' max='40' id='${c}-芝-water' style='width:70px;'></div>
 <div><label>ダート 含水</label><input type='number' step='0.1' min='0' max='40' id='${c}-ダート-water' style='width:70px;'></div>
 <button onclick='applyOne("${c}")'>反映</button><hr>`;
 inputCard.appendChild(div);
});

function applyOne(c){
 const cC=parseFloat(document.getElementById(`${c}-芝-cush`).value)||null;
 const cW=parseFloat(document.getElementById(`${c}-芝-water`).value)||null;
 const dW=parseFloat(document.getElementById(`${c}-ダート-water`).value)||null;
 todayTrack[c+"-芝"]={cush:cC,water:cW};
 todayTrack[c+"-ダート"]={cush:null,water:dW};
 renderView();
}

function renderView(){
 const c=document.getElementById('selCourse').value;
 const s=document.getElementById('selSurface').value;
 const d=document.getElementById('selDistance').value;
 const today=todayTrack[c+"-"+s]||{};
 const cush=today.cush??0;
 const water=today.water??0;
 const bar1=colorByCushion(cush);
 const bar2=colorByWater(water);
 const view=document.getElementById('viewCard');
 view.innerHTML=`<div style='font-weight:700;font-size:1rem;margin-bottom:6px;'>${c} ${s} ${d}m</div>
 <div class='bar-wrapper'><div class='bar-label'><span>クッション値 ${cush||'-'}</span></div><div class='bar-track'><div class='bar-fill' style='width:${(cush/12)*100}%;background:${bar1}'></div></div></div>
 <div class='bar-wrapper'><div class='bar-label'><span>含水率 ${water||'-'}%</span></div><div class='bar-track'><div class='bar-fill' style='width:${(water/40)*100}%;background:${bar2}'></div></div></div>`;
}
['selCourse','selSurface','selDistance'].forEach(id=>{
 document.getElementById(id).addEventListener('change',renderView);
});
renderView();

// タブ切り替え
const tabs=document.querySelectorAll('.tab-btn');
tabs.forEach(btn=>btn.addEventListener('click',()=>{
 tabs.forEach(b=>b.classList.remove('active'));
 btn.classList.add('active');
 document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));
 document.getElementById(btn.dataset.tab).classList.add('active');
}));
</script>
</body>
</html>
